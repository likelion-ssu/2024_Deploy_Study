# 쿠버네티스, 컨테이너, 도커

## 용어 정리

### 컨테이너

앱이 구동되는 환경까지 감싸서 실행할 수 있도록 하는 격리 기술

### 컨테이너 런타임

컨테이너를 다루는 도구

### 도커

컨테이너를 다루는 도구 중 가장 유명한 것

### 쿠버네티스

컨테이너 런타임을 통해 컨테이너를 오케스트레이션하는 도구

### 오케스트레이션

여러 서버에 걸친 컨테이너 및 사용하는 환경 설정을 관리하는 행위

쿠버네티스가 해주는 일은 여러 서버(노드)에 컨테이너를 분산해서 배치하거나, 문제가 생긴 컨테이너를 교체하거나, 컨테이너가 사용할 비밀번호나 환경 설정을 관리하고 주입해 주는 일 등  → 컨테이너 오케스트레이션

### 어플리케이션 환경의 변화

![Untitled](%E1%84%8F%E1%85%AE%E1%84%87%E1%85%A5%E1%84%82%E1%85%A6%E1%84%90%E1%85%B5%E1%84%89%E1%85%B3,%20%E1%84%8F%E1%85%A5%E1%86%AB%E1%84%90%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%82%E1%85%A5,%20%E1%84%83%E1%85%A9%E1%84%8F%E1%85%A5%2082f34e1f39a148298e730d26b859763a/Untitled.png)

- traditional deployment

가상화 이전, 물리적인 컴퓨터 한대에 하나의 os를 깔고 여러가지 프로그램을 실행시킴

- virtualized deployment

가상머신 기반으로 배포

hypervisor은 가상 컴퓨터를 여러 개 구동할 수 있게 해주는 중간 계층

bin/library는 프로그램 실행을 위해 필요한 환경 및 파일

- container deployment

컨테이너는 가상머신과 달리 프로그램 구동을 위해 os를 매번 설치할 필요가 없음 (하나의 os)

컨테이너 런타임 위에 OS와 하드웨어가 층으로 쌓여 있는 그림을 보고 전통적인 배포 위에서 컨테이너 런타임을 올렸다고 오해를 하곤 하는데, 컨테이너는 OS 하단이 어떻게 동작하는지 직접 관심을 두지 않음. 그래서 가상머신 위에 올라간 OS에서 컨테이너 기반 배포를 하는 것이 가능

컨테이너는 OS를 공유하는 방식이기 때문에,  어떤 프로그램의 문제가 다른 프로그램을 간섭할 수는 없음. 그러나 내 프로그램의 문제가 OS에 문제를 일으킬 경우에는 OS에서 구동 중인 전체 컨테이너의 문제가 될 가능성이 있음

**개발 용도**에 적합한 쿠버네티스 구성 방법은 **‘미니쿠브(Minikube)’**

- 장점

미니쿠브의 특징은 로컬 시스템에 쉽게 설치 가능

설치가 간단하면서도 쿠버네티스가 제공하는 대부분의 기능을 활용할 수 있다

- 단점

로컬에 설치되며 단일 노드 형태로 동작하기 때문에 다중 노드를 구성하여 수행해야 하는 작업 X

노드를 가상화된 형태로 생성하기 때문에 도커, 버추얼박스 등의 가상화 도구가 추가로 필요

학습 및 개발 환경을 넘어 보다 **실질적으로 활용** 가능한 쿠버네티스 클러스터를 구성하고 싶은데 리소스가 충분하지 않다면 **‘k3s’**

- 용도 : 쿠버네티스와 완전히 호환되는 가벼운 배포판
- 장점 : 설치가 쉽고 시스템 리소스를 적게 사용하면서 높은 쿠버네티스 호환성을 보장함
- 단점 : 구조가 매우 단순하므로 높은 성능과 안정성을 요구하는 시스템에는 부적합할 수 있음

조금 더 대규모 환경에 적합한 쿠버네티스 구성 방법을 찾는다면 **'랜처(Rancher)'**

- 용도 : 대규모 및 기업용 환경에서도 활용 가능한 다목적 쿠버네티스 관리 플랫폼
- 장점 : 기본적으로 포함되어 있는 기능이 많고 추가 도구 설치도 쉬움. 멀티 클라우드 관리 가능함
- 단점 : 다른 도구에 비해 무거우므로 시스템 환경에 따라 적절한 고려가 필요함

**실습 summary( 링크 참고 )**

나의 local 환경에서 VirtualBox 에 ubuntu 이미지로 VM을 생성하고,

해당 VM에 docker와 minikube(worker, master가 통합되어 제공되는 교육용 kubernetes) 를 설치한 후,

nginx web server를 돌리는 pod를 생성, 및 배포하도록

`deployment` 와 `service` 에 대한 yaml 파일을 작성해본다.

특히, 해당 nginx 웹 서버를 외부에서 접근 가능하도록 service의 `NodePort` 를 이용한다.

[https://velog.io/@dohyunkim12/Minikube-실습](https://velog.io/@dohyunkim12/Minikube-%EC%8B%A4%EC%8A%B5)